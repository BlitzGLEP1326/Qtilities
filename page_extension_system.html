<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Qtilities: Extension System</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<!-- Generated by Doxygen 1.8.1.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Extension System </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table  cellpadding="0" style="width:100%;
  table-layout:fixed;
	margin:0px 0px 0px 0px;
	border-width:0px 0px 0px 0px; 
	border-color:#7F7F7F;">
<tr>
<td style="width:80%; padding:0px 5px 0px 0px; vertical-align: text-top; text-align: left"><h1 style="margin:0px; padding:0px">Overview</h1>
<p></p>
<p>Qtilities provides an extension management library which has the following goals and responsibilities:</p>
<ul>
<li>Define how plugins interface with an application.</li>
<li>Getting the plugins up and running. This includes plugin loading, initialization and finalization.</li>
<li>Provide management of plugin configuration sets, that is: Provide control over which plugins must be loaded and initialized.</li>
<li>Provide information about the loaded plugins once they are loaded and initialized.</li>
</ul>
<p>The <a class="el" href="class_qtilities_1_1_extension_system_1_1_extension_system_core.html" title="The ExtensionSystemCore class is the core of the Qtilities extension system library.">Qtilities::ExtensionSystem::ExtensionSystemCore</a> singleton provides the interface through which these tasks can be achieved. This article will provide details of how the extension system achieves these goals and give an overview of the different features provided.</p>
<p>Table of contents:</p>
<ul>
<li><a class="el" href="page_extension_system.html#define_plugins">Goal 1: Define how plugins interface with an application</a></li>
<li><a class="el" href="page_extension_system.html#define_lifetime_management">Goal 2: Getting the plugins up and running</a><ul>
<li><a class="el" href="page_extension_system.html#loading_plugins">Loading plugins</a></li>
<li><a class="el" href="page_extension_system.html#init_and_finalization_sequence">Plugin initialization and finalization</a></li>
</ul>
</li>
<li><a class="el" href="page_extension_system.html#plugin_information">Goal 3: Provide plugin information at runtime</a></li>
<li><a class="el" href="page_extension_system.html#plugin_config_sets">Goal 4: Provide management of plugin configuration sets</a><ul>
<li><a class="el" href="page_extension_system.html#plugin_different_types">Plugin Classification</a></li>
<li><a class="el" href="page_extension_system.html#plugin_creating_sets">Creating Configuration Sets</a></li>
<li><a class="el" href="page_extension_system.html#plugin_creating_sets_user">Allowing Users Control Over Sets</a></li>
</ul>
</li>
</ul>
<p class="endtd"></p>
</td><td style="width:20%; vertical-align: top; margin:0px 0px 0px 0px;"><table  style="table-layout:auto;
	margin:0px 0px 0px 0px; 
  width: 100%;
	border-width:0px 0px 0px 0px; 
	border-color:#7F7F7F;
  background-color: #d1d3d4;">
<tr>
<td style="background-color: #5a5c5e; text-align: center"><h2 style="color:#FFFFFF">First Steps</h2>
<p class="endtd"></p>
</td></tr>
<tr>
<td><ul>
<li><a href="page_getting_started.html">Getting Started</a><br/>
</li>
<li><a href="page_the_basics.html">The Basics</a><br/>
</li>
<li><a href="page_examples_and_plugins.html">Examples and Plugins</a><br/>
   </li>
</ul>
</td></tr>
<tr>
<td style="background-color: #5a5c5e; text-align: center"><h2 style="color:#FFFFFF">Overviews</h2>
<p class="endtd"></p>
</td></tr>
<tr>
<td><ul>
<li><a href="page_action_management.html">Action Management</a><br/>
</li>
<li><a href="page_tree_structures.html">Building Trees</a><br/>
</li>
<li><a href="page_debugging.html">Debugging Applications</a><br/>
</li>
<li><a href="page_extension_system.html">Extension System</a><br/>
</li>
<li><a href="page_factories.html">Factories</a><br/>
</li>
<li><a href="page_logging.html">Logging</a><br/>
</li>
<li><a href="page_modules_overview.html">Modules</a><br/>
</li>
<li><a href="page_object_management.html">Object Management</a><br/>
</li>
<li><a href="page_observers.html">Observers</a><br/>
</li>
<li><a href="page_observer_widgets.html">Observer Widgets</a><br/>
</li>
<li><a href="page_project_management.html">Project Management</a><br/>
</li>
<li><a href="page_tasking.html">Tasking</a><br/>
</li>
<li><a href="page_widget_set.html">Widget Set</a><br/>
   </li>
</ul>
</td></tr>
</table>
</td></tr>
</table>
<h1><a class="anchor" id="define_plugins"></a>
Goal 1: Define how plugins interface with an application</h1>
<p>The <a class="el" href="class_qtilities_1_1_extension_system_1_1_interfaces_1_1_i_plugin.html" title="Interface used to communicate with plugins.">Qtilities::ExtensionSystem::Interfaces::IPlugin</a> interface defines the interface between the extension system and plugins it can load. The interface provides status information about the state of a plugin as well as information about the plugin itself and was made as lightweight as possible. Therefore it does not inherit from anything and any object can implement it.</p>
<p>Lets look at a simplified version of the <code>PluginTemplate</code> example in the <code>QtilitiesPlugins</code> project which is a ready to use template implementing this interface. First lets look at the header file: </p>
<div class="fragment"><div class="line"><span class="keyword">class </span>PluginTemplate : <span class="keyword">public</span> QObject, <span class="keyword">public</span> IPlugin</div>
<div class="line">{</div>
<div class="line">    Q_OBJECT</div>
<div class="line">    Q_INTERFACES(<a class="code" href="class_qtilities_1_1_extension_system_1_1_interfaces_1_1_i_plugin.html" title="Interface used to communicate with plugins.">Qtilities::ExtensionSystem::Interfaces::IPlugin</a>)</div>
<div class="line"></div>
<div class="line">public:</div>
<div class="line">    PluginTemplate(QObject* parent = 0);</div>
<div class="line">    ~PluginTemplate() {}</div>
<div class="line"></div>
<div class="line">    <span class="comment">// --------------------------------</span></div>
<div class="line">    <span class="comment">// IObjectBase Implementation</span></div>
<div class="line">    <span class="comment">// --------------------------------</span></div>
<div class="line">    QObject* objectBase() { <span class="keywordflow">return</span> <span class="keyword">this</span>; }</div>
<div class="line">    <span class="keyword">const</span> QObject* objectBase()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">this</span>; }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// --------------------------------------------</span></div>
<div class="line">    <span class="comment">// IPlugin Implementation</span></div>
<div class="line">    <span class="comment">// --------------------------------------------</span></div>
<div class="line">    <span class="keywordtype">bool</span> initialize(<span class="keyword">const</span> QStringList &amp;arguments, QStringList *error_strings);</div>
<div class="line">    <span class="keywordtype">bool</span> initializeDependencies(QStringList *error_strings);</div>
<div class="line">    <span class="keywordtype">void</span> finalize() {}</div>
<div class="line">    QString pluginName()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;Example Plugin&quot;</span>; }</div>
<div class="line">    QtilitiesCategory pluginCategory()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> QtilitiesCategory(<span class="stringliteral">&quot;General&quot;</span>); }</div>
<div class="line">    VersionInformation pluginVersionInformation() <span class="keyword">const</span>;</div>
<div class="line">    QString pluginPublisher() <span class="keyword">const</span>;</div>
<div class="line">    QString pluginPublisherWebsite() <span class="keyword">const</span>;</div>
<div class="line">    QString pluginPublisherContact() <span class="keyword">const</span>;</div>
<div class="line">    QString pluginDescription() <span class="keyword">const</span>;</div>
<div class="line">    QString pluginCopyright() <span class="keyword">const</span>;</div>
<div class="line">    QString pluginLicense() <span class="keyword">const</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><p>Next we look at the <code></code>.cpp implementation file: </p>
<div class="fragment"><div class="line">PluginTemplate::PluginTemplate(QObject* parent) : QObject(parent) {</div>
<div class="line">    setObjectName(pluginName());</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> PluginTemplate::initialize(<span class="keyword">const</span> QStringList &amp;arguments, QStringList *error_strings) {</div>
<div class="line">    Q_UNUSED(arguments)</div>
<div class="line">    Q_UNUSED(error_strings)</div>
<div class="line"></div>
<div class="line">    return true;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> PluginTemplate::initializeDependencies(QStringList *error_strings) {</div>
<div class="line">    Q_UNUSED(error_strings)</div>
<div class="line"></div>
<div class="line">    return true;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">Qtilities::Core::VersionInformation PluginTemplate::pluginVersionInformation()<span class="keyword"> const </span>{</div>
<div class="line">    VersionInformation version_info(1,0,0);</div>
<div class="line">    <span class="keywordflow">return</span> version_info;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">QString PluginTemplate::pluginPublisher()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Floware Computing (Pty) Ltd&quot;</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">QString PluginTemplate::pluginPublisherWebsite()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;http://www.qtilities.org&quot;</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">QString PluginTemplate::pluginPublisherContact()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;support@qtilities.org&quot;</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">QString PluginTemplate::pluginDescription()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> tr(<span class="stringliteral">&quot;An example Qtilities Extension System plugin.&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">QString PluginTemplate::pluginCopyright()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> QString(tr(<span class="stringliteral">&quot;Copyright&quot;</span>) + <span class="stringliteral">&quot; 2010, Floware Computing (Pty) Ltd&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">QString PluginTemplate::pluginLicense()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> tr(<span class="stringliteral">&quot;See the Qtilities Libraries license&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">Q_EXPORT_PLUGIN2(PluginTemplate, PluginTemplate);</div>
</div><!-- fragment --><p>The implementation above shows that it is very easy to implement the interface and the best place to start is to use <a class="el" href="namespace_qtilities_1_1_plugins_1_1_template.html" title="Namespace containing all classes which is part of the Template plugin.">Qtilities::Plugins::Template</a>.</p>
<h1><a class="anchor" id="define_lifetime_management"></a>
Goal 2: Getting the plugins up and running</h1>
<h2><a class="anchor" id="loading_plugins"></a>
Loading plugins</h2>
<p>The <a class="el" href="class_qtilities_1_1_extension_system_1_1_extension_system_core.html#a08a8db174cef08b04bdc5bb73e1aefbe" title="Initializes the plugin manager by loading all found plugins.">Qtilities::ExtensionSystem::ExtensionSystemCore::initialize()</a> function loads plugins from path(s) defined in <a class="el" href="class_qtilities_1_1_extension_system_1_1_extension_system_core.html#a77e2c4d35a0514427917c4214447ba89" title="Function to get the paths from where plugins are loaded.">Qtilities::ExtensionSystem::ExtensionSystemCore::pluginPaths()</a>. By default all plugins in the <code>EXECUTABLE_PATH/plugin</code> directory are loaded and new paths can be added using the <a class="el" href="class_qtilities_1_1_extension_system_1_1_extension_system_core.html#a4718bbac4cad0478d314ad47a08be0e3" title="Function to add a custom plugin path.">Qtilities::ExtensionSystem::ExtensionSystemCore::addPluginPath()</a> function.</p>
<p>During the loading process, the extension system core class emits the <code>newProcessMessage()</code> signal with progress messages which can be connected to a splash window if necessary (see the <a class="el" href="namespace_qtilities_1_1_examples_1_1_main_window.html" title="Namespace containing all the classes which forms part of the Main Window Example.">Qtilities::Examples::MainWindow</a> example which demonstrates this for more information).</p>
<p>The example below shows how to use the extension system to load plugins in your application's main() function.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;QtGui&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QtilitiesExtensionSystem&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span>QtilitiesCore;</div>
<div class="line"><span class="keyword">using namespace </span>QtilitiesCoreGui;</div>
<div class="line"><span class="keyword">using namespace </span>QtilitiesExtensionSystem;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">  QtilitiesApplication a(argc, argv);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// We must specify the following if we want the logger to remember its settings:</span></div>
<div class="line">  QtilitiesApplication::setOrganizationName(<span class="stringliteral">&quot;Floware Computing (Pty) Ltd&quot;</span>);</div>
<div class="line">  QtilitiesApplication::setOrganizationDomain(<span class="stringliteral">&quot;Qtilities&quot;</span>);</div>
<div class="line">  QtilitiesApplication::setApplicationName(<span class="stringliteral">&quot;Extension System Example&quot;</span>);</div>
<div class="line">  QtilitiesApplication::setApplicationVersion(<span class="stringliteral">&quot;0.1&quot;</span>);    </div>
<div class="line"></div>
<div class="line">  <span class="comment">// Initialize the logger:</span></div>
<div class="line">  QtilitiesApplication::applicationSessionPath();</div>
<div class="line">  LOG_INITIALIZE();</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Set the Qt message engine active, this will log messages to the Qt debugging system during the plugin loading process:</span></div>
<div class="line">  Log-&gt;toggleQtMsgEngine(<span class="keyword">true</span>);</div>
<div class="line">  <span class="comment">// Load plugins using the extension system:</span></div>
<div class="line">  EXTENSION_SYSTEM-&gt;initialize();</div>
<div class="line">  <span class="comment">// Set the Qt message engine inactive once the process loading process is completed:</span></div>
<div class="line">  Log-&gt;toggleQtMsgEngine(<span class="keyword">false</span>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Register extension system config page:</span></div>
<div class="line">  OBJECT_MANAGER-&gt;registerObject(EXTENSION_SYSTEM-&gt;configWidget());</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Report on the number of config pages found:</span></div>
<div class="line">  QList&lt;QObject*&gt; registered_config_pages = OBJECT_MANAGER-&gt;registeredInterfaces(<span class="stringliteral">&quot;com.Qtilities.CoreGui.IConfigPage/1.0&quot;</span>);</div>
<div class="line">  LOG_INFO(QString(<span class="stringliteral">&quot;%1 configuration page(s) found in set of loaded plugins.&quot;</span>).arg(registered_config_pages.count()));</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Create a config widget for this example:</span></div>
<div class="line">  ConfigurationWidget config_widget;</div>
<div class="line">  config_widget.initialize(registered_config_pages);</div>
<div class="line">  </div>
<div class="line">  exampleMainWindow-&gt;show();</div>
<div class="line">  <span class="keywordtype">int</span> result = a.exec();</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Finalize all plugins:</span></div>
<div class="line">  EXTENSION_SYSTEM-&gt;finalize();</div>
<div class="line">  <span class="comment">// Finalize the logger:</span></div>
<div class="line">  LOG_FINALIZE();</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The above example registers the <a class="el" href="class_qtilities_1_1_extension_system_1_1_plugin_info_widget.html" title="A widget that shows information about a plugin.">Qtilities::ExtensionSystem::PluginInfoWidget</a> widget in the global object pool which is discussed in the <a class="el" href="page_extension_system.html#plugin_information">Goal 3: Provide plugin information at runtime</a> section.</p>
<h2><a class="anchor" id="init_and_finalization_sequence"></a>
Plugin initialization and finalization</h2>
<p>The diagram below shows the sequence in which plugins are initialized during the plugin loading process.</p>
<div class="image">
<img src="plugin_loading_sequence.jpg" alt="plugin_loading_sequence.jpg"/>
<div class="caption">
Plugin Loading Sequence</div></div>
<p> Plugins should register any objects in which other plugins or the main application might be interested in (configuration pages, contexts) etc. in the <a class="el" href="class_qtilities_1_1_extension_system_1_1_interfaces_1_1_i_plugin.html#a3657a866c83dfee6fb6588e583181496" title="This function is called when the plugin is loaded.">Qtilities::ExtensionSystem::Interfaces::IPlugin::initialize()</a> function implementation. After all plugin instances were created and added to the global object pool, this function is called on all plugins. That is, all plugins are loaded first before any of them are initialized. To make things clear, lets look at simplified version of the <code>initialize()</code> function implementation in the <a class="el" href="namespace_qtilities_1_1_plugins_1_1_session_log.html" title="Namespace containing all classes which is part of the SessionLogPlugin.">Qtilities::Plugins::SessionLog</a> plugin:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="code" href="class_qtilities_1_1_plugins_1_1_session_log_1_1_session_log_plugin.html#a03fbcd30ea7b88578f93a3fb5421e6cd" title="This function is called when the plugin is loaded.">Qtilities::Plugins::SessionLog::SessionLogPlugin::initialize</a>(<span class="keyword">const</span> QStringList &amp;arguments, QStringList *error_strings) {</div>
<div class="line">    Q_UNUSED(arguments)</div>
<div class="line">    Q_UNUSED(error_strings)</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Add the session log mode to the global object pool:</span></div>
<div class="line">    SessionLogMode* session_log_mode = new SessionLogMode();</div>
<div class="line">    OBJECT_MANAGER-&gt;registerObject(session_log_mode);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Register the context of the session log mode:</span></div>
<div class="line">    CONTEXT_MANAGER-&gt;registerContext(session_log_mode-&gt;contextString());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Register the logging configuration widget:</span></div>
<div class="line">    OBJECT_MANAGER-&gt;registerObject(LoggerGui::createLoggerConfigWidget(false));</div>
<div class="line"></div>
<div class="line">    return true;</div>
<div class="line">}</div>
</div><!-- fragment --><p>This is followed by calling the <a class="el" href="class_qtilities_1_1_extension_system_1_1_interfaces_1_1_i_plugin.html#a37cf50704e0668a08c6d86dbfcca1ddc" title="This function is called when all the plugins in the system were loaded and initialized.">Qtilities::ExtensionSystem::Interfaces::IPlugin::initializeDependencies()</a> function on all plugins. In this function plugins can inspect the global object pool to for interfaces they are interested in using the <a class="el" href="class_qtilities_1_1_core_1_1_interfaces_1_1_i_object_manager.html#a0aa6c0f2090002b0c98e0b5b9b7220c3" title="Returns all objects in the global object pool which implements the specified interface.">Qtilities::Core::Interfaces::IObjectManager::registeredInterfaces()</a> function. Again, to make things clear lets write an implementation of the <code>initializeDependencies()</code> function which looks for all projects parts registered in the global object pool:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> ProjectPartFinderPlugin::initializeDependencies(QStringList *error_strings) {</div>
<div class="line">    Q_UNUSED(error_strings)</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Get a list of all the project items in the object pool:</span></div>
<div class="line">    QList&lt;QObject*&gt; projectItemObjects = OBJECT_MANAGER-&gt;registeredInterfaces(&quot;com.Qtilities.ProjectManagement.IProjectItem/1.0&quot;);</div>
<div class="line">    QList&lt;IProjectItem*&gt; projectItems;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Cast all items:</span></div>
<div class="line">    for (<span class="keywordtype">int</span> i = 0; i &lt; projectItemObjects.count(); i++) {</div>
<div class="line">        IProjectItem* part = qobject_cast&lt;IProjectItem*&gt; (projectItemObjects.at(i));</div>
<div class="line">        <span class="keywordflow">if</span> (part)</div>
<div class="line">          projectItems.append(part);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Now we will have a list with all the project items in the global object pool.</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="plugin_information"></a>
Goal 3: Provide plugin information at runtime</h1>
<p>The main access point to information about loaded plugins is the extension system configuration widget class (<a class="el" href="class_qtilities_1_1_extension_system_1_1_extension_system_config.html" title="The ExtensionSystemConfig class provides a ready to use configuration widget for the extension system...">Qtilities::ExtensionSystem::ExtensionSystemConfig</a>). The configuration widget is shown below:</p>
<div class="image">
<img src="extension_system_configuration_widget.jpg" alt="extension_system_configuration_widget.jpg"/>
<div class="caption">
Extension System Widget Plugin Overview</div></div>
<p> The "Plugin Paths" tab in the configuration widget provides details about the paths searched for plugins, thus it shows the paths returned by <a class="el" href="class_qtilities_1_1_extension_system_1_1_extension_system_core.html#a77e2c4d35a0514427917c4214447ba89" title="Function to get the paths from where plugins are loaded.">Qtilities::ExtensionSystem::ExtensionSystemCore::pluginPaths()</a>. For each plugin we can get detailed information by double clicking its name, or by clicking the "Details" button. The image below shows the detailed information of one of the provided Qtilities plugins.</p>
<div class="image">
<img src="extension_system_details_widget.jpg" alt="extension_system_details_widget.jpg"/>
<div class="caption">
Plugin Details</div></div>
 <h1><a class="anchor" id="plugin_config_sets"></a>
Goal 4: Provide management of plugin configuration sets</h1>
<p>In advanced applications it is often desirable to specify a set of plugins which should be loaded for different scenarios. In Qtilities we call a set of plugins that must be loaded for a specific scenario a plugin configuration set.</p>
<h2><a class="anchor" id="plugin_different_types"></a>
Plugin Classification</h2>
<p>The extension system allow management of different configuration sets which groups plugins into the following groups:</p>
<ul>
<li><b>Active Plugins:</b> Plugins which are loaded and initialized.</li>
<li><b>Inactive Plugins:</b> Plugins which are loaded but not initialized. This is needed in order for the plugin to still be shown in the plugin details widget and to allow user control over creation of configuration sets.</li>
<li><b>Filtered Plugins:</b> Plugins which are filtered/skipped, thus not loaded or initialized. This is usefull in scenarios where the same application is deployed to different places and only specific plugins should be exposed to users when they create plugin configuration sets.</li>
<li><b>Core Plugins:</b> These plugins form the core of an application. Thus they must always be treated as active plugins (thus loaded and initialized).</li>
</ul>
<p>A configuration set gives the names of the plugins which falls into the inactive and filtered plugin groups. When a plugin is found during the <a class="el" href="class_qtilities_1_1_extension_system_1_1_extension_system_core.html#a08a8db174cef08b04bdc5bb73e1aefbe" title="Initializes the plugin manager by loading all found plugins.">Qtilities::ExtensionSystem::ExtensionSystemCore::initialize()</a> function call, the plugin is checked agains the information provided by the configuration set and handled accordingly. When a plugin is found which is not categorized in the configuration set, it automatically falls under the Active Plugins category. In the same way, if a plugin occurs under more than one category in the configuration set, it automatically falls under the Active Plugins set.</p>
<p>The <a class="el" href="class_qtilities_1_1_extension_system_1_1_extension_system_core.html" title="The ExtensionSystemCore class is the core of the Qtilities extension system library.">Qtilities::ExtensionSystem::ExtensionSystemCore</a> class provides different functions to get information about the plugins that fell into the different categories during initialization.</p>
<h2><a class="anchor" id="plugin_creating_sets"></a>
Creating Configuration Sets</h2>
<p>Creating configuration sets is easy and flexible. The important thing to remember is: The plugin configuration set that will be used is the one that is active at the time that the extension system's <code>initialize()</code> function is called. There are different ways to set it up:</p>
<ul>
<li>Manually calling the functions that grounp plugins into different categories, like <a class="el" href="class_qtilities_1_1_extension_system_1_1_extension_system_core.html#a8439c39605be98e7fa8e9b605013ce20" title="Function to set the names of all plugins which should be handled as core plugins. That is...">Qtilities::ExtensionSystem::ExtensionSystemCore::setCorePlugins()</a> for example.</li>
<li>Loading the configuration from a XML file (ending with <code></code>.pconfig by default). The configuration setup can be saved to a XML file at any stage. The debug plugin allows you to create custom sets, for more information see <a class="el" href="page_debugging.html#debugging_plugins_custom">Creating Custom Plugin Configuration Sets</a>.</li>
</ul>
<p>Below is an example plugin configuration set file:</p>
<div class="fragment"><div class="line">&lt;!DOCTYPE QtilitiesPluginConfiguration&gt;</div>
<div class="line">&lt;QtilitiesPluginConfiguration QtilitiesVersion=<span class="stringliteral">&quot;0.3.0&quot;</span> <a class="code" href="namespace_qtilities.html#a46a5ca954966c57c74662ac6e6d8aa25" title="The possible versions supported by Qtilities::Core::Intefaces::IExportable.">ExportVersion</a>=<span class="stringliteral">&quot;0&quot;</span>&gt;</div>
<div class="line">  &lt;InactivePlugins&gt;</div>
<div class="line">    &lt;PluginName Value=<span class="stringliteral">&quot;Test Plugin 1&quot;</span>/&gt;</div>
<div class="line">    &lt;PluginName Value=<span class="stringliteral">&quot;Test Plugin 2&quot;</span>/&gt;</div>
<div class="line">    &lt;PluginName Value=<span class="stringliteral">&quot;Test Plugin 3&quot;</span>/&gt;</div>
<div class="line">  &lt;/InactivePlugins&gt;</div>
<div class="line">  &lt;FilteredPlugins&gt;</div>
<div class="line">    &lt;Expression Value=<span class="stringliteral">&quot;Filter1*&quot;</span>/&gt;</div>
<div class="line">    &lt;Expression Value=<span class="stringliteral">&quot;Filter2*&quot;</span>/&gt;</div>
<div class="line">    &lt;Expression Value=<span class="stringliteral">&quot;Filter3*&quot;</span>/&gt;</div>
<div class="line">  &lt;/FilteredPlugins&gt;</div>
<div class="line">&lt;/QtilitiesPluginConfiguration&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="plugin_creating_sets_user"></a>
Allowing Users Control Over Sets</h2>
<p>The developer will have a specific way in mind that he or she wants to manage configuration sets their of application. To accomodate different scenarios the way that sets are handled can be customized through the <code>ExtensionSystemCore</code> class. It is for example possible to define some core plugins and then let the user decide which plugins they want to be active and incative.</p>
<p>The plugin details widget can either show the current active and inactive plugins without allowing the user to change it, or it can give full control to the user. To show the activity of plugins and to allow the users to control the activity of plugins, use the following functions on the extension system:</p>
<div class="fragment"><div class="line">EXTENSION_SYSTEM-&gt;enablePluginActivityDisplay();</div>
<div class="line">EXTENSION_SYSTEM-&gt;enablePluginActivityControl();</div>
</div><!-- fragment --><p>Below is an example of the plugin configuration widget with the above two activity options enabled and with the "Session Log Plugin" specified to be a core plugin (thus it is greyed out to indicate this and a proper message is displayed when an attempt is made to deactivate it). The image shows the state of the widget just after the user disabled the "Project Management Plugin".</p>
<div class="image">
<img src="extension_system_widget_with_config_control.jpg" alt="extension_system_widget_with_config_control.jpg"/>
<div class="caption">
Plugin Configuration Set Display</div></div>
<p> When the user is given control over plugin configuration sets, changing the current set will automatically save the new configuration to the file name of the loaded set. By default this is <code>App_Path/session/default.pconfig</code>. However if a valid plugin configuration has been loaded using the <a class="el" href="class_qtilities_1_1_extension_system_1_1_extension_system_core.html#a78c03d64c35f7b14269afd58a0d3eda8" title="Function which loads a plugin configuration file.">Qtilities::ExtensionSystem::ExtensionSystemCore::loadPluginConfiguration()</a> function, this loaded configuration file will be updated to reflect the changes the user made. The <a class="el" href="class_qtilities_1_1_extension_system_1_1_extension_system_core.html#a44b18a6e23befd43968f57e1cfb056f0" title="Sets the name of the current plugin configuration set&#39;s file.">Qtilities::ExtensionSystem::ExtensionSystemCore::setActivePluginConfigurationFile()</a> function can be specified. It is important to note that the extension system's <code>initialize()</code> function loads the active plugin configuration file automatically if it exists. Thus is does not make sense to load the configuration before calling <code>initialize()</code> unless you want to modify it. </p>
</div></div><!-- contents -->
<br><table style="table-layout:auto;	margin: auto; 	border-width:0px 0px 0px 0px; 	border-color:#7F7F7F; 	width:99%;	border-style:solid" CELLPADDING=5 RULES=ROWS FRAME=HSIDES><tr><td style="align: left;width:45%"><a href="http://www.qtilities.org" title="Qtilities Website">Qtilities</a> : <a href="index.html" title="Go back to index">Reference Documentation</a></td><td style="align: center;width:10%"><a href="#top" title="Back to top">Back to top</a> </td><td style="text-align: right;width:45%">Copyright &copy; 2009-2013, Floware Computing (Pty) Ltd</tr></table><br><script type="text/javascript">  var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-17785825-1']);  _gaq.push(['_trackPageview']);  (function() {    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);  })();</script>
