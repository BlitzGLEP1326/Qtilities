<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Qtilities: Building Trees</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<!-- Generated by Doxygen 1.8.1.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Building Trees </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table  cellpadding="0" style="width:100%;
  table-layout:fixed;
	margin:0px 0px 0px 0px;
	border-width:0px 0px 0px 0px; 
	border-color:#7F7F7F;">
<tr>
<td style="width:80%; padding:0px 5px 0px 0px; vertical-align: text-top; text-align: left"><h1 style="margin:0px; padding:0px">Overview</h1>
<p></p>
<p>Qtilities provides a set of classes which make tree building a trivial task. This article will explore these classes and show different ways to build trees. The tree classes also provides many additional features which comes in handy and saves time. The main class doing the work behind the scenes is <a class="el" href="class_qtilities_1_1_core_1_1_observer.html" title="The observer class is an extended implementation of an observer in the subject-observer pattern...">Qtilities::Core::Observer</a>. However this article will not look at the details of how things work, it will just show how to use the classes and build trees without worrying how it works in the background. The <a class="el" href="page_observers.html">Observers</a> article is a good place to start if you are interested in the details.</p>
<p>Table of contents:</p>
<ul>
<li><a class="el" href="page_tree_structures.html#tree_building_classes">Tree building classes</a></li>
<li><a class="el" href="page_tree_structures.html#lets_build_some_trees">Lets build some trees</a><ul>
<li><a class="el" href="page_tree_structures.html#tree_basic_trees">Basic trees</a></li>
<li><a class="el" href="page_tree_structures.html#tree_categorized_leafs">Tree with categorized leafs</a></li>
<li><a class="el" href="page_tree_structures.html#tree_uncategorized_leafs">Tree without categorized leafs</a></li>
<li><a class="el" href="page_tree_structures.html#tree_xml">Saving and loading trees using XML</a></li>
<li><a class="el" href="page_tree_structures.html#tree_formatted">Formatted tree which combines categorized and uncategorized nodes</a></li>
<li><a class="el" href="page_tree_structures.html#tree_specialized_nodes">More advanced trees: Controlling activity and names of items under a node</a></li>
</ul>
</li>
<li><a class="el" href="page_tree_structures.html#tree_structures_features">Handy tree features</a><ul>
<li><a class="el" href="page_tree_structures.html#tree_parent_child_access">Parent and child access functions</a></li>
<li><a class="el" href="page_tree_structures.html#monitor_changes">Monitoring changes to the tree</a></li>
<li><a class="el" href="page_tree_structures.html#compare_trees">Compare trees with each other</a></li>
<li><a class="el" href="page_tree_structures.html#trees_lifetime_monitoring">Trees automatically monitor the lifetime of objects in it</a></li>
</ul>
</li>
<li><a class="el" href="page_tree_structures.html#tree_parsing">Under the hood: How trees are parsed</a><ul>
<li><a class="el" href="page_tree_structures.html#tree_parsing_areas">Tree parsing areas</a></li>
<li><a class="el" href="page_tree_structures.html#tree_parsing_observer_observer">Approach 1: Observer with child observers</a></li>
</ul>
</li>
</ul>
<p class="endtd"></p>
</td><td style="width:20%; vertical-align: top; margin:0px 0px 0px 0px;"><table  style="table-layout:auto;
	margin:0px 0px 0px 0px; 
  width: 100%;
	border-width:0px 0px 0px 0px; 
	border-color:#7F7F7F;
  background-color: #d1d3d4;">
<tr>
<td style="background-color: #5a5c5e; text-align: center"><h2 style="color:#FFFFFF">First Steps</h2>
<p class="endtd"></p>
</td></tr>
<tr>
<td><ul>
<li><a href="page_getting_started.html">Getting Started</a><br/>
</li>
<li><a href="page_the_basics.html">The Basics</a><br/>
</li>
<li><a href="page_examples_and_plugins.html">Examples and Plugins</a><br/>
   </li>
</ul>
</td></tr>
<tr>
<td style="background-color: #5a5c5e; text-align: center"><h2 style="color:#FFFFFF">Overviews</h2>
<p class="endtd"></p>
</td></tr>
<tr>
<td><ul>
<li><a href="page_action_management.html">Action Management</a><br/>
</li>
<li><a href="page_tree_structures.html">Building Trees</a><br/>
</li>
<li><a href="page_debugging.html">Debugging Applications</a><br/>
</li>
<li><a href="page_extension_system.html">Extension System</a><br/>
</li>
<li><a href="page_factories.html">Factories</a><br/>
</li>
<li><a href="page_logging.html">Logging</a><br/>
</li>
<li><a href="page_modules_overview.html">Modules</a><br/>
</li>
<li><a href="page_object_management.html">Object Management</a><br/>
</li>
<li><a href="page_observers.html">Observers</a><br/>
</li>
<li><a href="page_observer_widgets.html">Observer Widgets</a><br/>
</li>
<li><a href="page_project_management.html">Project Management</a><br/>
</li>
<li><a href="page_tasking.html">Tasking</a><br/>
</li>
<li><a href="page_widget_set.html">Widget Set</a><br/>
   </li>
</ul>
</td></tr>
</table>
<p class="endtd"></p>
</td></tr>
</table>
<h1><a class="anchor" id="tree_building_classes"></a>
Tree building classes</h1>
<p>Before starting to build actual trees, lets look at the set of tree building classes provided which are shown below, where classes doing work behind the scenes are colored in grey.</p>
<div class="image">
<img src="tree_building_classes.jpg" alt="tree_building_classes.jpg"/>
<div class="caption">
Tree Building Classes</div></div>
<p> The different classes has different responsibilities:</p>
<ul>
<li><a class="el" href="class_qtilities_1_1_core_1_1_observer.html" title="The observer class is an extended implementation of an observer in the subject-observer pattern...">Qtilities::Core::Observer</a> : A normal Observer class which allows attachment of items to tree nodes. It is also responsible to monitor the modification state of TreeNode as well as the exportability.</li>
<li><a class="el" href="class_qtilities_1_1_core_gui_1_1_abstract_tree_item.html" title="The AbstractTreeItem is an abstract base class which can be used to build tree items.">Qtilities::CoreGui::AbstractTreeItem</a> : A base class which is implemented by all tree items and nodes. This class provides easy access to the name, formatting and category of any item which can appear in the tree.</li>
<li><a class="el" href="class_qtilities_1_1_core_gui_1_1_tree_node.html" title="The TreeNode class is a node in a tree which can have items attached to it and can also be attached t...">Qtilities::CoreGui::TreeNode</a> : A tree item which allows attachment of other items or nodes to it.</li>
<li><a class="el" href="class_qtilities_1_1_core_gui_1_1_tree_item_base.html" title="The TreeItemBase class is the base class for all tree items, that is items which can be attached to T...">Qtilities::CoreGui::TreeItemBase</a> : Implements the modification state of tree items inheriting from it. It also expose formatting options using Q_PROPERTY.</li>
<li><a class="el" href="class_qtilities_1_1_core_gui_1_1_tree_item.html" title="The TreeItem class is an item in a tree. It can be attached to a TreeNode.">Qtilities::CoreGui::TreeItem</a> : A basic tree item (Leaf Node).</li>
<li><a class="el" href="class_qtilities_1_1_core_gui_1_1_tree_file_item.html" title="The TreeFileItem class is an item in a tree which can be used to easily represent files...">Qtilities::CoreGui::TreeFileItem</a> : A specific type of tree item which allows easy attachment of files to a tree structure.</li>
</ul>
<p>It is easy extend the set of tree items by creating objects which inherit from <a class="el" href="class_qtilities_1_1_core_gui_1_1_tree_item_base.html" title="The TreeItemBase class is the base class for all tree items, that is items which can be attached to T...">Qtilities::CoreGui::TreeItemBase</a>.</p>
<h1><a class="anchor" id="lets_build_some_trees"></a>
Lets build some trees</h1>
<p>Trees are constructed on the principle that the <a class="el" href="class_qtilities_1_1_core_gui_1_1_tree_node.html" title="The TreeNode class is a node in a tree which can have items attached to it and can also be attached t...">Qtilities::CoreGui::TreeNode</a> class can contain child items (leaf nodes) or other tree nodes. This allows us to build any tree structure that we want and in this section we will discuss and show how to build trees with different requirements.</p>
<p>The <code>BuildingTreeStructures</code> example in the <code>QtilitiesExamples</code> project shows a few trees which you can play around with or change to code to change the trees. The screenshot below shows this example in action:</p>
<div class="image">
<img src="example_building_tree_structures.jpg" alt="example_building_tree_structures.jpg"/>
<div class="caption">
Building Tree Structures Example</div></div>
 <h2><a class="anchor" id="tree_basic_trees"></a>
Basic trees</h2>
<p>Lets look at a very simple tree with a depth of 2 which looks like the one shown below.</p>
<div class="image">
<img src="observer_dot_graph_example_tree_dot.jpg" alt="observer_dot_graph_example_tree_dot.jpg"/>
<div class="caption">
Basic Tree Of Depth 2</div></div>
<p> To build this tree using Qtilities is done like this: </p>
<div class="fragment"><div class="line"><span class="comment">// Create tree structure:</span></div>
<div class="line">TreeNode* node = <span class="keyword">new</span> TreeNode(<span class="stringliteral">&quot;Root Node&quot;</span>);</div>
<div class="line">node-&gt;addItem(<span class="stringliteral">&quot;Item 1&quot;</span>);</div>
<div class="line">node-&gt;addItem(<span class="stringliteral">&quot;Item 2&quot;</span>);</div>
<div class="line">node-&gt;addItem(<span class="stringliteral">&quot;Item 3&quot;</span>);</div>
</div><!-- fragment --><p>We can increase the depth to 3 and also introduce an advanced concept of Qtilities trees where any item in the tree can have multiple parents. The "Shared Item" in the tree below has both "Node A" and "Node B" as its parents.</p>
<div class="image">
<img src="observer_dot_graph_example_complex_tree_dot.jpg" alt="observer_dot_graph_example_complex_tree_dot.jpg"/>
<div class="caption">
Tree With Shared Item Of Depth 3</div></div>
<p> To build this tree using Qtilities is done like this: </p>
<div class="fragment"><div class="line"><span class="comment">// Create tree structure:</span></div>
<div class="line">TreeNode* node = <span class="keyword">new</span> TreeNode(<span class="stringliteral">&quot;Root Node&quot;</span>);</div>
<div class="line"></div>
<div class="line">TreeNode* nodeA = node-&gt;addNode(<span class="stringliteral">&quot;Node A&quot;</span>);</div>
<div class="line">nodeA-&gt;addItem(<span class="stringliteral">&quot;Item 1&quot;</span>);</div>
<div class="line">nodeA-&gt;addItem(<span class="stringliteral">&quot;Item 2&quot;</span>);</div>
<div class="line">TreeItem* sharedItem = nodeA-&gt;addItem(<span class="stringliteral">&quot;Shared Item&quot;</span>);</div>
<div class="line"></div>
<div class="line">TreeNode* nodeB = node-&gt;addNode(<span class="stringliteral">&quot;Node B&quot;</span>);</div>
<div class="line">nodeB-&gt;attachSubject(sharedItem);</div>
<div class="line">nodeB-&gt;addItem(<span class="stringliteral">&quot;Item 3&quot;</span>);</div>
<div class="line">nodeB-&gt;addItem(<span class="stringliteral">&quot;Item 4&quot;</span>);</div>
</div><!-- fragment --><p>As you can see, building trees with Qtilities is easy. It is important to understand we are using two basic classes, <a class="el" href="class_qtilities_1_1_core_gui_1_1_tree_node.html" title="The TreeNode class is a node in a tree which can have items attached to it and can also be attached t...">Qtilities::CoreGui::TreeNode</a> and <a class="el" href="class_qtilities_1_1_core_gui_1_1_tree_item.html" title="The TreeItem class is an item in a tree. It can be attached to a TreeNode.">Qtilities::CoreGui::TreeItem</a> here. However it is possible to build trees with your own items where tree nodes are based on <a class="el" href="class_qtilities_1_1_core_1_1_observer.html" title="The observer class is an extended implementation of an observer in the subject-observer pattern...">Qtilities::Core::Observer</a> and your leaf items can be any QObject based class. The <a class="el" href="page_tree_structures.html#tree_specialized_nodes">More advanced trees: Controlling activity and names of items under a node</a> section of this page introduces more advanced concepts but for now we will focus on building trees on a higher level and displaying them.</p>
<p>For the curious reader, the tree diagrams shown above were created using <a class="el" href="class_qtilities_1_1_core_1_1_observer_dot_writer.html" title="The ObserverDotWriter class generate dot scripts to create dot graphs for an observer tree...">Qtilities::Core::ObserverDotWriter</a>.</p>
<h2><a class="anchor" id="tree_categorized_leafs"></a>
Tree with categorized leafs</h2>
<p>An important feature of a tree node is that is can group child items into categories where a category icon will automatically be assigned to category nodes. This functionality is controlled by the <a class="el" href="class_qtilities_1_1_core_gui_1_1_tree_node.html#a81008f45cc1264620351ee5ad8b2365f" title="Enables categorized display on this node.">Qtilities::CoreGui::TreeNode::enableCategorizedDisplay()</a> function. The first tree is a simple tree which uses this feature to group items into different categories. The advantage of the categorized approach is that it is very simple to use and we can easily construct very deep trees since we don't have to construct the category nodes manually. The disadvantage is that we don't have access to the category nodes, thus we cannot control their formatting or define the context used for items inside the category (activity or naming control for example).</p>
<div class="image">
<img src="tree_docs_categorized_tree.jpg" alt="tree_docs_categorized_tree.jpg"/>
<div class="caption">
Tree With Categorized Leaf Nodes</div></div>
<p> The actual implementation is show below:</p>
<div class="fragment"><div class="line">TreeNode* rootNode = <span class="keyword">new</span> TreeNode(<span class="stringliteral">&quot;Root&quot;</span>);</div>
<div class="line">rootNode-&gt;enableCategorizedDisplay();</div>
<div class="line">rootNode-&gt;addItem(<span class="stringliteral">&quot;Child 1&quot;</span>,QtilitiesCategory(<span class="stringliteral">&quot;Category 1&quot;</span>));</div>
<div class="line">rootNode-&gt;addItem(<span class="stringliteral">&quot;Child 2&quot;</span>,QtilitiesCategory(<span class="stringliteral">&quot;Category 1&quot;</span>));</div>
<div class="line">rootNode-&gt;addItem(<span class="stringliteral">&quot;Child 3&quot;</span>,QtilitiesCategory(<span class="stringliteral">&quot;Category 2&quot;</span>));</div>
<div class="line">rootNode-&gt;addItem(<span class="stringliteral">&quot;Child 4&quot;</span>,QtilitiesCategory(<span class="stringliteral">&quot;Category 2&quot;</span>));</div>
<div class="line">rootNode-&gt;addItem(<span class="stringliteral">&quot;Child 5&quot;</span>,QtilitiesCategory(<span class="stringliteral">&quot;Category 2&quot;</span>));</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespace_qtilities_1_1_core_gui.html#afd8fdc61c432918c7062359639689892" title="Makes ObserverWidget available under the name TreeWidget.">TreeWidget</a>* categorized_widget = <span class="keyword">new</span> <a class="code" href="namespace_qtilities_1_1_core_gui.html#afd8fdc61c432918c7062359639689892" title="Makes ObserverWidget available under the name TreeWidget.">TreeWidget</a>(rootNode);</div>
<div class="line">categorized_widget-&gt;show();</div>
</div><!-- fragment --><p>Note that deep trees can be constructed by using different constructors of <a class="el" href="class_qtilities_1_1_core_1_1_qtilities_category.html" title="A QtilitiesCategory object represents a category in Qtilities.">Qtilities::Core::QtilitiesCategory</a>. For example: </p>
<div class="fragment"><div class="line">rootNode-&gt;addItem(<span class="stringliteral">&quot;Child 1&quot;</span>,QtilitiesCategory(<span class="stringliteral">&quot;Top Category::Middle Category::Bottom Category&quot;</span>,<span class="stringliteral">&quot;::&quot;</span>));</div>
</div><!-- fragment --><h2><a class="anchor" id="tree_uncategorized_leafs"></a>
Tree without categorized leafs</h2>
<p>Building trees without categories is powerful but becomes tedious when a tree gets deep and the nodes have to be created manually. Lets build the same tree again, but this time without using categories. To keep the examples to follow short, the code to create and show the observer widget is not repeated again.</p>
<div class="image">
<img src="tree_docs_uncategorized_tree.jpg" alt="tree_docs_uncategorized_tree.jpg"/>
<div class="caption">
Tree With Categorized Leaf Nodes</div></div>
<p> The actual implementation is show below:</p>
<div class="fragment"><div class="line">TreeNode* rootNode = <span class="keyword">new</span> TreeNode(<span class="stringliteral">&quot;Root&quot;</span>);</div>
<div class="line">TreeNode* parentNode1 = rootNode-&gt;addNode(<span class="stringliteral">&quot;Parent 1&quot;</span>);</div>
<div class="line">TreeNode* parentNode2 = rootNode-&gt;addNode(<span class="stringliteral">&quot;Parent 2&quot;</span>);</div>
<div class="line">parentNode1-&gt;addItem(<span class="stringliteral">&quot;Child 1&quot;</span>);</div>
<div class="line">parentNode1-&gt;addItem(<span class="stringliteral">&quot;Child 2&quot;</span>);</div>
<div class="line">parentNode2-&gt;addItem(<span class="stringliteral">&quot;Child 3&quot;</span>);</div>
<div class="line">parentNode2-&gt;addItem(<span class="stringliteral">&quot;Child 4&quot;</span>);</div>
<div class="line">parentNode2-&gt;addItem(<span class="stringliteral">&quot;Child 5&quot;</span>);</div>
</div><!-- fragment --><p>It is clear from the above example that deep trees will take much more lines of code than the categorized approach. This approach does however allows for much more complex trees to be build. In the trees that follow this will become apparent.</p>
<h2><a class="anchor" id="tree_xml"></a>
Saving and loading trees using XML</h2>
<p>A very powerful feature of Qtilities trees are that they can save any created tree to a XML file and reconstruct it at a later time. A tree can also be defined entirely in XML and then constructed in memory and shown to the user.</p>
<p>Lets demonstrate this using the example tree presented thus far. Lets assume we append this to the above example: </p>
<div class="fragment"><div class="line">QString fileName = QApplication::applicationDirPath() + <span class="stringliteral">&quot;/example_tree.xml&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">// Save the tree to a file:</span></div>
<div class="line">rootNode-&gt;saveToFile(fileName);</div>
<div class="line"></div>
<div class="line"><span class="comment">// Load the tree from a file:</span></div>
<div class="line">rootNode-&gt;loadFromFile(fileName);</div>
<div class="line"></div>
<div class="line"><span class="comment">// Or add the node produced from a file as a child to a node:</span></div>
<div class="line">rootNode-&gt;addNodeFromFile(fileName);</div>
</div><!-- fragment --><p>The format of the output tree is defined by <a class="el" href="namespace_qtilities.html#a46a5ca954966c57c74662ac6e6d8aa25" title="The possible versions supported by Qtilities::Core::Intefaces::IExportable.">Qtilities::ExportVersion</a> and a detailed overview of the output format can be found on the <a class="el" href="page_serializing_overview.html">Serializing Qtilities Data Types Overview</a> page.</p>
<h2><a class="anchor" id="tree_formatted"></a>
Formatted tree which combines categorized and uncategorized nodes</h2>
<p>Tree nodes and items (excluding category nodes) all inherit <a class="el" href="class_qtilities_1_1_core_gui_1_1_abstract_tree_item.html" title="The AbstractTreeItem is an abstract base class which can be used to build tree items.">Qtilities::CoreGui::AbstractTreeItem</a> which provides functions to format these items. For more details on the allowed formatting, see the class documentation. It is possible to combine the two approaches described thus far. That is, we can create a tree with tree nodes using categories along with other tree nodes which does not use categories.</p>
<p>Lets create a formatted tree to demonstrate this.</p>
<div class="fragment"><div class="line">TreeNode* nodeA = <span class="keyword">new</span> TreeNode(<span class="stringliteral">&quot;Node A&quot;</span>);</div>
<div class="line">TreeNode* nodeB = nodeA-&gt;addNode(<span class="stringliteral">&quot;Node B&quot;</span>);</div>
<div class="line">TreeNode* nodeC = nodeA-&gt;addNode(<span class="stringliteral">&quot;Node C&quot;</span>);</div>
<div class="line">nodeC-&gt;enableCategorizedDisplay();</div>
<div class="line"></div>
<div class="line"><span class="comment">// Add some formatting to the nodes:</span></div>
<div class="line">nodeA-&gt;setForegroundRole(QBrush(Qt::darkRed));</div>
<div class="line">nodeA-&gt;setFont(QFont(<span class="stringliteral">&quot;Helvetica [Cronyx]&quot;</span>,20));</div>
<div class="line">nodeA-&gt;setAlignment(Qt::AlignCenter);</div>
<div class="line">nodeA-&gt;setBackgroundRole(QBrush(Qt::gray));</div>
<div class="line">nodeB-&gt;setForegroundRole(QBrush(Qt::darkGreen));</div>
<div class="line">nodeB-&gt;setFont(QFont(<span class="stringliteral">&quot;Helvetica [Cronyx]&quot;</span>,20));</div>
<div class="line">nodeB-&gt;setAlignment(Qt::AlignCenter);</div>
<div class="line">nodeB-&gt;setBackgroundRole(QBrush(Qt::gray));</div>
<div class="line">nodeC-&gt;setForegroundRole(QBrush(Qt::darkYellow));</div>
<div class="line">nodeC-&gt;setFont(QFont(<span class="stringliteral">&quot;Helvetica [Cronyx]&quot;</span>,20));</div>
<div class="line">nodeC-&gt;setAlignment(Qt::AlignCenter);</div>
<div class="line">nodeC-&gt;setBackgroundRole(QBrush(Qt::gray));</div>
<div class="line"></div>
<div class="line"><span class="comment">// Create the tree items:</span></div>
<div class="line"><span class="comment">// Be careful to use it like this, this is just to keep the example short.</span></div>
<div class="line"><span class="comment">// If the addItem() call fails it returns 0.</span></div>
<div class="line">nodeA-&gt;addItem(<span class="stringliteral">&quot;Item 1&quot;</span>)-&gt;setStatusTip(<span class="stringliteral">&quot;Hello, I&#39;m a status tip.&quot;</span>);</div>
<div class="line">nodeB-&gt;addItem(<span class="stringliteral">&quot;Item 2&quot;</span>)-&gt;setIcon(QIcon(qti_icon_EDIT_COPY_16x16));</div>
<div class="line">nodeB-&gt;addItem(<span class="stringliteral">&quot;Item 3&quot;</span>)-&gt;setIcon(QIcon(qti_icon_EDIT_CLEAR_16x16));</div>
<div class="line">nodeB-&gt;addItem(<span class="stringliteral">&quot;Item 4&quot;</span>)-&gt;setIcon(QIcon(qti_icon_EDIT_CUT_16x16));</div>
<div class="line">nodeC-&gt;addItem(<span class="stringliteral">&quot;Item 5&quot;</span>)-&gt;setWhatsThis(<span class="stringliteral">&quot;Hello, I&#39;m a What&#39;s This message.&quot;</span>);</div>
<div class="line">nodeC-&gt;addItem(<span class="stringliteral">&quot;Item 6&quot;</span>)-&gt;setToolTip(<span class="stringliteral">&quot;Hello, I&#39;m a ToolTip text&quot;</span>);</div>
<div class="line">nodeC-&gt;addItem(<span class="stringliteral">&quot;Item 7&quot;</span>)-&gt;setCategory(QtilitiesCategory(<span class="stringliteral">&quot;Category 1&quot;</span>),nodeC);</div>
<div class="line"></div>
<div class="line"><span class="comment">// Create an observer widget with the items:</span></div>
<div class="line"><a class="code" href="namespace_qtilities_1_1_core_gui.html#afd8fdc61c432918c7062359639689892" title="Makes ObserverWidget available under the name TreeWidget.">TreeWidget</a>* tree_widget = <span class="keyword">new</span> <a class="code" href="namespace_qtilities_1_1_core_gui.html#afd8fdc61c432918c7062359639689892" title="Makes ObserverWidget available under the name TreeWidget.">TreeWidget</a>(nodeA);</div>
<div class="line">tree_widget-&gt;show();</div>
</div><!-- fragment --><p>The resulting tree is shown below. Note that "Node C" contains categorized items while the other two nodes does not use categories. There is no limitation on combining different nodes. It is for example possible to attach an uncategorized node to a specific category in a categorized node.</p>
<div class="image">
<img src="trees_simple_example_formatted.jpg" alt="trees_simple_example_formatted.jpg"/>
<div class="caption">
Formatted Tree Combining Categorized and Uncategorized Nodes</div></div>
 <h2><a class="anchor" id="tree_specialized_nodes"></a>
More advanced trees: Controlling activity and names of items under a node</h2>
<p>Controlling the activity and/or names of items under a node is a common requirement found in applications. The tree building classes makes this very easy. The image below shows the required tree and its implementation.</p>
<div class="image">
<img src="tree_docs_more_advanced_tree.jpg" alt="tree_docs_more_advanced_tree.jpg"/>
<div class="caption">
More Advanced Tree: Activity and Naming Control</div></div>
<p> The actual implementation is show below:</p>
<div class="fragment"><div class="line">TreeNode* rootNode = <span class="keyword">new</span> TreeNode(<span class="stringliteral">&quot;Root&quot;</span>);</div>
<div class="line">TreeNode* parentNode1 = rootNode-&gt;addNode(<span class="stringliteral">&quot;Parent 1&quot;</span>);</div>
<div class="line">parentNode1-&gt;enableActivityControl(ObserverHints::CheckboxActivityDisplay,ObserverHints::CheckboxTriggered);</div>
<div class="line">TreeNode* parentNode2 = rootNode-&gt;addNode(<span class="stringliteral">&quot;Parent 2&quot;</span>);</div>
<div class="line">parentNode2-&gt;enableNamingControl(ObserverHints::EditableNames,NamingPolicyFilter::ProhibitDuplicateNames);</div>
<div class="line">parentNode1-&gt;addItem(<span class="stringliteral">&quot;Child 1&quot;</span>);</div>
<div class="line">parentNode1-&gt;addItem(<span class="stringliteral">&quot;Child 2&quot;</span>);</div>
<div class="line">parentNode2-&gt;addItem(<span class="stringliteral">&quot;Child 3&quot;</span>);</div>
<div class="line">parentNode2-&gt;addItem(<span class="stringliteral">&quot;Child 4&quot;</span>);</div>
<div class="line">parentNode2-&gt;addItem(<span class="stringliteral">&quot;Child 5&quot;</span>);</div>
</div><!-- fragment --><p>For the above code we see that it is possible to easily define how activity and naming control must be handled for items under a tree node. This example is only the tip of the iceberg and only shows the solution to one required tree. The activity control provides many options to the user. We can for example tell <code>parentNode1</code> that only one child can be active at one time, or that the activity must follow the user's selection when items underneath <code>parentNode1</code> are selected. It is also possible to define custom policies for a tree node or policies can be combined. The goal of this article is not to explore these features in depth. If you are interested in all the features available to developers, the following are good places to start:</p>
<p><b>Articles</b></p>
<ul>
<li>The <a class="el" href="page_observer_widgets.html">Observer Widgets</a> article.</li>
<li>The <a class="el" href="page_observers.html#subject_filters">Subject filters</a> section of the <a class="el" href="page_observers.html">Observers</a> article.</li>
</ul>
<p><b>API Documentation</b></p>
<ul>
<li><a class="el" href="class_qtilities_1_1_core_1_1_observer_hints.html" title="The ObserverHints class contains display hints for an Observer class.">Qtilities::Core::ObserverHints</a></li>
<li><a class="el" href="class_qtilities_1_1_core_1_1_observer.html" title="The observer class is an extended implementation of an observer in the subject-observer pattern...">Qtilities::Core::Observer</a> which is the base class of tree nodes and does all the work in the background.</li>
<li><a class="el" href="class_qtilities_1_1_core_1_1_activity_policy_filter.html" title="The ActivityPolicyFilter class is an implementation of AbstractSubjectFilter which allows control ove...">Qtilities::Core::ActivityPolicyFilter</a></li>
<li><a class="el" href="class_qtilities_1_1_core_gui_1_1_naming_policy_filter.html" title="The NamingPolicyFilter class is an implementation of AbstractSubjectFilter which allows control over ...">Qtilities::CoreGui::NamingPolicyFilter</a></li>
<li><a class="el" href="class_qtilities_1_1_core_1_1_subject_type_filter.html" title="A subject filter which only allows attachement of specific object types.">Qtilities::Core::SubjectTypeFilter</a></li>
</ul>
<p>It would not be possible to meet the requirements of the above tree using the categorized approach. The important thing to remember when building trees is that each node defines a context for the items attached to it. This allows us to control for example activity, or names for items underneath a node. Using the categorized approach results in a node which contains all its children, does not matter in which category they are, in one context. This can be desired in specific cases and in those cases categorized nodes in a tree is the way to go.</p>
<h1><a class="anchor" id="tree_structures_features"></a>
Handy tree features</h1>
<p>Now that we've shown how to build some example trees, we look at other features and advantages of the Qtilities tree structure.</p>
<h2><a class="anchor" id="tree_parent_child_access"></a>
Parent and child access functions</h2>
<p>Any object can have multiple parents and can be attached anywhere in the tree multiple times. Thus we can get the reference of a tree item under a node and attach it to a different node. From a user's perspective the result looks the same but from a developers perspective this open the door to additional possibilities when building trees. We can get the parents or children of any item in the tree as follows:</p>
<div class="fragment"><div class="line"><span class="comment">// Get the number of parents:</span></div>
<div class="line"><span class="keywordtype">int</span> parent_count = Observer::parentCount(obj);</div>
<div class="line"></div>
<div class="line"><span class="comment">// Get the references of any objects&#39; parents:</span></div>
<div class="line">QList&lt;Observer*&gt; parents = Observer::parentReferences(obj);</div>
<div class="line"></div>
<div class="line"><span class="comment">// Get the number of children:</span></div>
<div class="line"><span class="keywordtype">int</span> child_count = node-&gt;subjectCount();</div>
<div class="line"></div>
<div class="line"><span class="comment">// Get the references to all children:</span></div>
<div class="line">QList&lt;QObject*&gt; children = node-&gt;subjectReferences();</div>
</div><!-- fragment --><p>A limitation of this flexibility is that recursive tree structures are not allowed and this is automatically checked each time a new child is attached to a node. The <a class="el" href="class_qtilities_1_1_core_gui_1_1_tree_node.html" title="The TreeNode class is a node in a tree which can have items attached to it and can also be attached t...">Qtilities::CoreGui::TreeNode</a> class provides many other useful functions to use. See the class documentation for more information.</p>
<h2><a class="anchor" id="monitor_changes"></a>
Monitoring changes to the tree</h2>
<p>A powerful feature is the ability to monitor modifications to a tree. This is done through the <a class="el" href="class_qtilities_1_1_core_1_1_interfaces_1_1_i_modification_notifier.html" title="Interface which allows objects to broadcast changes made to them.">Qtilities::Core::Interfaces::IModificationNotifier</a> interface. This interface allows any object in the tree to broadcast any changes to its modification state. An example of where this is useful is where a tree is part of a project. In that case we want to indicate to the user that the project must be saved as soon as the tree structure or any of the objects in the tree change.</p>
<p>We can check if a the example tree is modified, and change the modification state of the tree as follows:</p>
<div class="fragment"><div class="line"><span class="comment">// Check if the tree is modified</span></div>
<div class="line"><span class="keywordflow">if</span> (rootNode-&gt;isModified()){</div>
<div class="line">  <span class="comment">// If it is modified, we change its modification state to false for this example:</span></div>
<div class="line">  rootNode-&gt;setModificationState(<span class="keyword">false</span>,IModificationNotifier::NotifySubjects);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Tree nodes also provide a number of signals which can be monitored if you are interested in specific changes in a tree. See the <a class="el" href="class_qtilities_1_1_core_1_1_observer.html" title="The observer class is an extended implementation of an observer in the subject-observer pattern...">Qtilities::Core::Observer</a> class documentation for more information.</p>
<h2><a class="anchor" id="compare_trees"></a>
Compare trees with each other</h2>
<p>Trees can be compared to each other, and information about a tree can be serialized to a QDataStream using the <a class="el" href="class_qtilities_1_1_core_1_1_observer_relational_table.html" title="The ObserverRelationalTable class is a data structure which stores relational data about an observer ...">Qtilities::Core::ObserverRelationalTable</a> class.</p>
<div class="fragment"><div class="line">ObserverRelationalTable tableA(parentNode1);</div>
<div class="line"><span class="comment">// Now we can dump detailed information about the tree to the logger</span></div>
<div class="line">tableA.dumpTableInfo();</div>
<div class="line"></div>
<div class="line"><span class="comment">// We can compare two trees with each other:</span></div>
<div class="line">ObserverRelationalTable tableB(parentNode2);</div>
<div class="line"><span class="keywordflow">if</span> (!tableA.compare(tableB)) {</div>
<div class="line">  <span class="comment">// Tables are different, which will be the case for the example tree</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>We can also export detailed information about a tree to files are read them back at a later time. See <a class="el" href="class_qtilities_1_1_core_gui_1_1_tree_node.html#a32fe924950aa8848ce9ca66c6cb8dc73" title="Saves the tree under this tree node to an XML file.">Qtilities::CoreGui::TreeNode::saveToFile()</a> for more information.</p>
<h2><a class="anchor" id="trees_lifetime_monitoring"></a>
Trees automatically monitor the lifetime of objects in it</h2>
<p>Trees automatically monitor the lifetime of objects inside the tree. Thus if we delete any item or node in a tree the tree will automatically refresh any observer widgets displaying it.</p>
<div class="fragment"><div class="line"><span class="comment">// We can also delete all objects in the tree like this:</span></div>
<div class="line">rootNode-&gt;deleteAll();</div>
<div class="line"></div>
<div class="line"><span class="comment">// If we want to remove all objects from the tree but we don&#39;t want to delete them we do this:</span></div>
<div class="line">rootNode-&gt;detachAll();</div>
</div><!-- fragment --><p>Note that <code>rootNode</code> will still have its objects attached to them after the <code>detachAll()</code> call. It is important to avoid memory leaks when detaching objects, thus you must then manually manage the lifetime. See <a class="el" href="page_observers.html#object_lifetimes">Object lifetimes: Managing object lifetimes using observers</a> for more information on this topic.</p>
<h1><a class="anchor" id="tree_parsing"></a>
Under the hood: How trees are parsed</h1>
<p>The tree building classes presented thus far deal with trees from a user's perspective. We defined how the must look to the user and then created it. The Qtilities tree structure provides the ability to build trees with any objects. That is, we can create a tree node and attach any <code>QObject</code> to it. When the tree is displayed the <code>objectName()</code> of the attached object is used as the name of the item. We can also build trees that will never be shown to the user, for example we create a tree and define the ownerships of the items in the tree in such a way that the lifetimes of objects in the tree is managed in a specific way (think of garbage collection).</p>
<p>Because trees can be so generic, they are parsed in a very specific way depending on what you are doing with the tree. This section provides details of how the parsing happens inside the Qtilities classes.</p>
<h2><a class="anchor" id="tree_parsing_areas"></a>
Tree parsing areas</h2>
<p>In Qtilities trees are parsed in several places and it is important to make sure parsing happens in the same way everywhere. The following list gives an overview of classes where tree parsing happens:</p>
<ul>
<li><a class="el" href="class_qtilities_1_1_core_1_1_observer_relational_table.html" title="The ObserverRelationalTable class is a data structure which stores relational data about an observer ...">Qtilities::Core::ObserverRelationalTable</a></li>
<li><a class="el" href="class_qtilities_1_1_core_1_1_observer.html" title="The observer class is an extended implementation of an observer in the subject-observer pattern...">Qtilities::Core::Observer</a> which is, as mentioned before, the base class of tree nodes.</li>
<li><a class="el" href="class_qtilities_1_1_core_gui_1_1_observer_tree_model.html" title="The ObserverTreeModel class provides an ready-to-use model that can be used to show the children of a...">Qtilities::CoreGui::ObserverTreeModel</a></li>
<li><a class="el" href="class_qtilities_1_1_core_gui_1_1_observer_table_model.html" title="The ObserverTableModel class provides an ready-to-use model that can be used to show the contents of ...">Qtilities::CoreGui::ObserverTableModel</a></li>
<li><a class="el" href="class_qtilities_1_1_core_gui_1_1_observer_widget.html" title="The ObserverWidget class provides a ready-to-use widget to display information about a specific obser...">Qtilities::CoreGui::ObserverWidget</a></li>
</ul>
<p>All of these classes support the following approaches to parsing trees.</p>
<h2><a class="anchor" id="tree_parsing_observer_observer"></a>
Approach 1: Observer with child observers</h2>
<p>This approach is the most common and easiest and was used in the examples presented in this article so far. The tree is made up of Observers with other observers underneath it, with other observers underneath these observers etc. </p>
</div></div><!-- contents -->
<br><table style="table-layout:auto;	margin: auto; 	border-width:0px 0px 0px 0px; 	border-color:#7F7F7F; 	width:99%;	border-style:solid" CELLPADDING=5 RULES=ROWS FRAME=HSIDES><tr><td style="align: left;width:45%"><a href="http://www.qtilities.org" title="Qtilities Website">Qtilities</a> : <a href="index.html" title="Go back to index">Reference Documentation</a></td><td style="align: center;width:10%"><a href="#top" title="Back to top">Back to top</a> </td><td style="text-align: right;width:45%">Copyright &copy; 2009-2013, Floware Computing (Pty) Ltd</tr></table><br><script type="text/javascript">  var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-17785825-1']);  _gaq.push(['_trackPageview']);  (function() {    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);  })();</script>
